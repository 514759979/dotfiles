#!/bin/bash

export PATH=$PATH:$HOME/.screenlayout
export EDITOR=vim
export BROWSER=firefox
export PAGER='less -isrf'
export UNZIP='-O CP936'
export GREP_OPTIONS='--color=auto'
export GREP_COLOR='40;33;01'
eval `dircolors $HOME/.dir_colors`

# man color
export LESS_TERMCAP_mb=$'\E[01;31m'
export LESS_TERMCAP_md=$'\E[01;31m'
export LESS_TERMCAP_me=$'\E[0m'
export LESS_TERMCAP_se=$'\E[0m'
export LESS_TERMCAP_so=$'\E[01;44;33m'
export LESS_TERMCAP_ue=$'\E[0m'
export LESS_TERMCAP_us=$'\E[01;32m'

st() {
    setsid $* &>/dev/null
}

gq() {
    st geeqie $*
}

imgresize() {
    gm mogrify -resize $1x$2 $3
}

cry() {
    if [ "t$1" = "t-d" ]; then
        openssl enc -aes-256-cbc -d -in $2 -out $3
    else
        openssl enc -aes-256-cbc -e -in $1 -out $2
    fi
}


c() {
    cd $1
    ls -F --color
}

zcd() {
    cd ~/.avfs$PWD/$@#
}

zback() {
    cd $(pwd|sed -e 's|^.*\.avfs||g' -e 's|/[^/]*#$||g')
}

aftp() {
    cd /home/osily/.avfs/#ftp:$1
}

vmvfs() {
    echo $PWD | grep '.avfs' &>/dev/null && cd
    convmvfs /mnt/fuse -o srcdir=$PWD,icharset=gb18030
    cd /mnt/fuse/
}

#atool
file_7z='\.rar\b|\.deb\b|\.iso\b'

al() {
    if echo $* |grep -Pi $file_7z >/dev/null; then
        als $* -F 7z
    else
        als $*
    fi
}

a() {
    if echo $* |grep -Pi $file_7z >/dev/null; then
        apack $* -F 7z
    else
        apack $*
    fi
}

au() {
    if echo $* |grep -Pi $file_7z >/dev/null; then
        arepack $* -F 7z
    else
        arepack $*
    fi
}

x() {
    if echo $* |grep -Pi $file_7z >/dev/null; then
        aunpack $* -F 7z
    else
        aunpack $*
    fi
}

#end atool

mcat() {
    markdown_py2 $1 -f /tmp/.html
    w3m /tmp/.html
    rm /tmp/.html
}

wpa() {
    sudo ifconfig wlan0 up
    wpa_passphrase $1 $2 > /tmp/wpa_supplicant.conf.tmp
    sudo wpa_supplicant -B -Dwext -i wlan0 -c /tmp/wpa_supplicant.conf.tmp
}

findx() {
    find -print0 | xargs -0 $@
}

calc() {
    zmodload zsh/mathfunc 2>/dev/null
    echo $[$*]
}

gr() {
    grep --color "$*" -r .
}

b() {
    if [ $# = 0 ]; then
        cd ..
    else
        go_dir='.'
        for i in {1..$1}; do
            go_dir=$go_dir/..
        done
        cd $go_dir
    fi

    ls -F --color
}

opsqlite_chromium() {
    cd $HOME/.config/chromium
    find -print0|xargs -0 file|grep SQLite|sed 's/:.*$//g' > .opsqlite
    while read i; do
        sqlite3 $i vacuum
    done < .opsqlite
    rm .opsqlite
    cd -
}

opsqlite_firefox() {
    cd ~/.mozilla/firefox/
    for i in `find -name '*.sqlite'`; do
        sqlite3 $i vacuum
    done
    cd -
}

sl() {
    if pgrep ckermit &>/dev/null; then
        sll1 $1
    else
        sll2 $1
    fi
}

j() {
    sudo mount -o iocharset=utf8,uid=1000,gid=1000 /dev/$1 /mnt
}

cwi() {
    cat `which $1`
}

vwi() {
    vim `which $1`
}

mm() {
    echo "$2" | mutt ly50247@126.com -s "$1" $3 $4
}

ba() {
    o "http://www.baidu.com/s?wd=$*"
}

csd() {
    now=$(cat ~/.asoundrc.asoundconf | awk '/defaults.ctl.card/ {print $2}')
    new=$(asoundconf list | sed "1d; /$now/d; /ThinkPadEC/d")
    asoundconf set-default-card $new
}

ac() {
    if [ $# = 1 ]; then
        awk '{print $'$1'}' $2
    elif [ $# = 2 ]; then
        awk -F$2 '{print $'$1'}' $3
    elif [ $# = 0 ]; then
        awk '{print $1}' $1
    fi
}

smb() {
    sudo mount -o relatime,nobarrier,compress=lzo,ssd_spread,space_cache,autodefrag,inode_cache,subvol=$1 $2 /mnt
}

fordo() {
    cmd=$1
    shift
    for i in $*; do
        eval $cmd $i
    done
}

y() {
    pacman-color -Ss $*
    cat ~/.myconf/aurlist | grep -Pi --color=none "$*" | awk -F'  ' '{
        a=" "$3" ["$1"] ("$4") {"$6"}"
        print "\033[35;1maur/\033[36;1m" $2 "\033[32;1m" a "\033[0m"
        print "    "$5
    }'
}

pbg() {
    wget http://mirrors.ustc.edu.cn/gentoo/distfiles/$1
}

pqii() {
    cat /var/lib/pacman/local/$1-*/install
}

if which yaourt &>/dev/null; then
    alias p='yaourt'
    alias pi='p -S'
    alias pia='p -S --noconfirm'
    alias pli='p -U'
    alias pud='p -Syu --aur'
    alias psu='p -Su --aur'
    alias pd='p -Sw'
    alias pp='p -Rcsn'
    alias psi='p -Si'
    alias pq='p -Q'
    alias pqi='p -Qi'
    alias pqe='pacman -Qeq'
    alias psl='pkgfile -l'
    alias pql='p -Ql'
    alias pso='pkgfile -v'
    alias pqo='p -Qo'
    alias pqd='p -Qdt'
    alias pqm='p -Qqm'
    alias prd='p -Rdd'
    alias pae='p -D --asexplicit'
    alias pad='p -D --asdeps'
    alias pcl='echo y"\n"y | p -Scc'
    alias pbs='p -G'
elif which emerge &>/dev/null; then
    alias p='eix'
    alias pi='sudo emerge -uDN'
    alias psu='sudo emerge -uDN world'
    alias pp='sudo emerge -c'
    alias prd='sudo emerge -C'
    alias pud='sudo emerge --sync'
    alias pd='sudo emerge -f'
    alias pql='equery f'
    alias pqo='equery b'
    alias pq='equery l'
    alias psi='emerge -pv'
    alias pli='sudo emerge -k'
elif which jumbo &>/dev/null; then
    alias p='jumbo search'
    alias pi='jumbo install'
    alias pp='jumbo remove'
    alias pql='jumbo list-files'
    alias pli='jumbo local-install'
    alias pud='jumbo update'
    alias pqd='jumbo check-unused'
fi

alias h='history'
alias l='ls -F --color'
alias lsd='l -d *(-/DN)'
alias ll='l -l --time-style=long-iso'
alias la='l -A'
alias lla='ll -A'
alias llh='ll -h'
alias g='grep'
alias rd='rmdir'
alias md='mkdir'
alias v='vim'
alias sv='sudo vim'
alias py='python2'
alias info='info --vi-keys'
alias s='sudo'
alias hd='hexdump -C'
alias le="$PAGER"
alias sm='sudo mount'
alias u='sudo umount'
alias fu='fusermount -u'
alias dh='df -hT'
alias pyweb='SimpleHTTPServerWithUpload.py 8888'
alias ucat='iconv -f gb18030 -t utf-8 -c'
alias gcat='iconv -f utf-8 -t gb18030 -c'
alias u16cat='iconv -f utf-16 -t utf-8 -c'
alias dub='du -sbh'
alias dud='du -d 1 -bh '
alias psg='ps aux|grep -v grep|grep'
alias psa='ps aux'
alias pst='pstree'
alias mt='top -u osily'
alias ctime='time cat'
alias ck='sudo ckermit ~/.kermrc -c'
alias ma='mountavfs'
alias ua='umountavfs'
alias lg='luit -encoding gb18030'
alias wi='which'
alias rpd='rm -r $PWD;cd ..'
alias rpdf='rm -rf $PWD;cd ..'
alias bd='setsid ~/.bnac/bnac.py &>/dev/null'
alias cpui='cat /proc/cpuinfo|grep MHz'
alias cl='xclip -se cl -i'
alias gi='LANG=zh_CN.UTF-8 gimp &>/dev/null &'
alias ledon='sudo sh -c "echo 255 > /sys/class/leds/tpacpi::thinklight/brightness"'
alias ledoff='sudo sh -c "echo 0 > /sys/class/leds/tpacpi::thinklight/brightness"'
alias lid_close='xset dpms force off'
alias wvd='sudo wvdial -C ~/.wvdialrc'
alias find0='find -print0'
alias xargs0='xargs -0'
alias findg='find|grep -P'
alias se='sudo systemctl'
alias ehttp='export http_proxy=http://127.0.0.1:8087'
alias ehttps='export https_proxy=http://127.0.0.1:8087'
alias eh='ehttp;ehttps'
alias e='echo'
alias f='file'
alias t='cat'
alias i='git'
alias ic='ifconfig'
alias sic='sudo ifconfig'
alias k='kill'
alias pk='pkill'
alias ka='killall'
alias k9='kill -9'
alias pk9='pkill -9'
alias ka9='killall -9'
alias m='man'
alias mp='mplayer'
alias q='exit'
alias vd='vimdiff'
alias wl='wc -l'
alias sen='sensors'
alias di='colordiff'
alias les='/usr/share/vim/vim73/macros/less.sh'
alias frm='free -m'
alias fm='ranger'
alias d='tree'
alias z='xargs'
alias gmc='gm convert'
alias pre='perl-rename'
alias mtu='sudo ifconfig wlan0 mtu 1480'
alias jl='ll /dev/sd*; ll /dev/mmc*'
alias tf='tailf'
alias pb='cat ~/.myconf/source_list | grep'
alias bv='bviplus'
alias makerom='rm -f META-INF/{CERT.RSA,CERT.SF}; a tmp.zip .; signapk tmp.zip update.zip; rm tmp.zip'
alias pywebc="ifconfig | awk '/inet.*broadcast/ {print \$2 \":8888\"}' | cl"
alias cpu='sudo cpupower frequency-set -f '
alias cpug'=sudo cpupower frequency-set -g ondemand'
alias vbox='st VirtualBox --comment win7 --startvm win7 --no-startvm-errormsgbox'
alias fb='fbterm'
alias ng='netcfg'
